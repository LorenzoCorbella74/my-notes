<h2><b>Database</b></h2><div><b>&gt; <span style="background-color: rgb(254, 250, 0);">mongod</span></b>                 E’ l’applicazione server che gestisce le connessioni al database mongoDB (aspetta sulla porta 27017)<b><br></b></div><b>&gt; <span style="background-color: rgb(254, 250, 0);">mongo</span></b>                   E’ la shell di mongoDB da cui si può impartire i vari comandi connettendosi al mongod server<div><b>&gt; <span style="background-color: rgb(254, 250, 0);">show dbs </span></b><span style="background-color: rgb(254, 250, 0);"> </span>            mostra una lista dei db</div><div><b>&gt; <span style="background-color: rgb(254, 250, 0);">use mioDB</span></b><span style="background-color: rgb(254, 250, 0);"> </span>           seleziona un db “mioDB”  e se non esiste lo crea.</div><div><b>&gt; <span style="background-color: rgb(254, 250, 0);">db</span>    </b>                       per vedere qual'è il db corrente</div><div><b>&gt; db.dropDatabase() </b>per cancellare il db corrente</div><div><b>&gt; cls     </b>                     per pulire la console</div><div><br></div><h2>Collection</h2><div>L'oggetto <b>db</b> avrà pertanto il valore “<b> nomedb</b>” e sarà l’oggetto che useremo per interagire con il database.</div><div>Per creare un db e relativa una collection</div><div><b>&gt; video.movies</b></div><div><br></div><div>Per la creazione delle collection si ha:</div><div><b>&gt; db.createCollection("<span style="line-height: 1.4;">miaCollection </span>“</b><span style="line-height: 1.4;"><b>) </b>oppure</span></div><div><b>&gt; db.miaCollection     </b>                               crea  la collection avente nome "<b>miaCollection  </b>“     oppure</div><div><b>&gt; db.</b><b>miaCollection .insert</b><b>( { prop1:value1} ) </b>       non importa crearle in quanto vengono create automaticamente quando si inseriscono i documenti<br></div><div><b>&gt; db.</b><b>miaCollection </b><b>.count() </b>       per vedere quanti document ha la collection “<b>miaCollection  </b>”</div><div><b>&gt; db.</b><b>miaCollection </b><b>.drop() </b>         per cancellare la collection “<b>miaCollection  </b>”<br></div><div><b><span style="background-color: rgb(254, 250, 0);">&gt; show collections </span>   </b>                   per vedere le collections</div><div><br></div><h2>creare Documents</h2><div>Si inserisce un documento (riga):</div><div><b style="line-height: 1.4;">&gt; db.[collectionName].</b><b>save</b>({ name: 'Chris' }); </div><div><br></div><div><b>&gt; db.[collectionName].insert( </b>document<b> );        </b><u>si può inserire un oggetto o un array di oggetti</u></div><div><b>&gt; db.[collectionName].insert( </b>{ title:”Tutorial MongoDb”, url:”http://tutsplus.com/mongodb”, comment:”Great tutorial”, tags:[“tutorial”,”databse”], save_on: new Date() <b>} );</b><b><br></b></div><div><br></div><div>Si poteva anche utilizzare javascript da terminale:</div><div>&gt; var doc={};</div><div>&gt; doc.title=<span style="line-height: 1.4;">”Tutorial MongoDb”;</span></div><div><span style="line-height: 1.4;">&gt; doc.url=”http://tutsplus.com/mongodb”;</span></div><div><span style="line-height: 1.4;">&gt; doc.comment=”Great tutorial”;</span></div><div><span style="line-height: 1.4;">&gt; doc.tags=[“tutorial”,”databse”];</span></div><div><span style="line-height: 1.4;">&gt; doc.save_on: new Date();</span></div><div><span style="line-height: 1.4;">&gt; doc.meta={};</span></div><div><span style="line-height: 1.4;">&gt; doc.meta.browser=</span>“<span style="line-height: 1.4;">Google chrome 24</span>”<span style="line-height: 1.4;">;</span></div><div><span style="line-height: 1.4;">&gt; doc.meta.OS=</span>“<span style="line-height: 1.4;">MAC OS 10.8.2</span>”<span style="line-height: 1.4;">;</span><span style="line-height: 1.4;"><br></span></div><div><span style="line-height: 1.4;"><b>&gt; doc </b>                             permette di visualizzare il document inserito</span></div><div><span style="line-height: 1.4;"><b>&gt; doc.miaCollection.save(doc);  &nbsp;</b></span></div><div><span style="line-height: 1.4;"><br></span></div><div><span style="line-height: 1.4;">Se non si specifica aggiunge un </span>“<span style="line-height: 1.4;">_id</span>”<span style="line-height: 1.4;">:</span>”<span style="line-height: 1.4;"> OjectId(</span>“<span style="line-height: 1.4;">33113412423424134124</span>”<span style="line-height: 1.4;">) field che rappresenta la primary key&nbsp;o identificatore unico per mongodb (12 bytes, hexadecimal number). </span><span style="line-height: 1.4;">Una volta salvato non si può cambiare l</span><span style="line-height: 1.4;">’</span><span style="line-height: 1.4;"> _id in quanto <u>unico e immutabile </u>ed assegnato dal sistema come nei db relazionali, basato sul sistema, sulla data in cui il documento è stato salvato, etc. L</span><span style="line-height: 1.4;">’</span><span style="line-height: 1.4;"> _id permette (eventualmente) di relazionare i documenti tra loro.</span></div><h3><span style="line-height: 1.4;"><br></span></h3><h3><span style="line-height: 1.4;">CERCARE DATI (query)</span></h3><div><b>&gt; db.</b><b>miaCollection </b><b>.find();    </b>                        ritorna tutti i documenti nella collection (in formato non formattato).</div><div><span style="background-color: rgb(254, 250, 0);"><b>&gt; db.</b><b>miaCollection </b></span><b><span style="background-color: rgb(254, 250, 0);">.find() .pretty();  </span>  </b>          ritorna tutti i documenti nella collection in formato formattato.<br></div><div><b>&gt; db.</b><b>miaCollection </b><b>.find() .explain();    </b>       .explain() specifica la verbosità del risultato.<br></div><div><b>&gt; db.</b><b>miaCollection </b><b>.find({ nome:”Lorenzo”, cognome:”Corbella"});    </b>          trova per uguaglianza (o per &lt;, &gt;, &lt;=,&gt;=, != ). La virgola rappresenta l’AND mentre per lOR si deve usare la sintassi:<br></div><div>{ $or : [<b><span style="line-height: 1.4;">{ nome:”Lorenzo”}, {cognome:”Corbella</span>”<span style="line-height: 1.4;">}]</span></b></div><div><b>&gt; db.</b><b>miaCollection </b><b>.find( { nome: {exist : true} } );  </b> se la proprietà esiste<b><span style="line-height: 1.4;"><br></span></b></div><div><b>&gt; db.</b><b>miaCollection </b><b>.find().limit(5);    </b>          limita il risultato della query.<br></div><div><b>&gt; db.</b><b>miaCollection </b><b>.find()[0];    </b>                   metodo per ritornare il 1° elemento del db<br></div><div><b>&gt; db.</b><b>miaCollection </b><b>.find()[0]._id;                 </b>metodo per ritornare nel 1°elemento il field specifico<br></div><div><b>&gt; db.</b><b>miaCollection </b><b>.find()[0]._id.getTimeStamp();   </b>metodo per ritornare la data di creazione dello specifico documento in base al campo “_id"<br></div><div><b>&gt; db.</b><b>miaCollection </b><b>.find() .forEach(printjson);     </b>fà la query e permette una visualizzazione idonea sul terminal.<br></div><h3><br>Query operators ( si passa un oggetto con dentro i query operator</h3><div><ul><li>$gt, $gte, $in (exist in), $lt, $lte,$ne (not equal to), $nin (does not exist..)</li><li>Customer.find( {discount: {$gte:10} , function(err,results){   // console.log(results; } });</li></ul></div><h3>Aggiornare/cancellare un documento</h3><div><b>&gt; db.nomeCollection.update(selectionCriteria, updated data) </b> permette di aggiornare i singoli valori</div><div>&gt; db.users.update({ name: 'Holly' }, { name: 'Holly Lloyd' });
</div><div><br></div><div><b>&gt; db.nomeCollection.remove(deleteCriteria, 1)</b>  rimuove un solo documento (riga)<br></div><div>&gt; db.users.remove({ name: 'Holly' });<br></div><div><br></div><div><b>&gt; db.nomeCollection.remove()</b>                              rimuove tutti i documenti<br></div><div>&gt; db.users.remove({});</div><div><br></div><div><b>Es:</b></div><div><div>&gt; var a = db.movies.find()</div><div>&gt; a.<b>hasNext()  </b>// permette di vedere se ha un valore successivo (ritorna true/false)</div><div>&gt; a.<b>next()</b></div></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div>
